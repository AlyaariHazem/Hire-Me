<div id="saved-jobs">
  <div class="dashboard-header">
    <h1 class="dashboard-title">الوظائف المحفوظة</h1>
    <div class="dashboard-actions">
      <a routerLink="/jobseeker/jobs" class="btn btn-primary"
        >البحث عن المزيد</a
      >
    </div>
  </div>

  <div class="content-card">
    <!-- loading -->
     @if(loading){
       <div class="saved-jobs-state">
         <p>جارٍ تحميل الوظائف المحفوظة...</p>
       </div>
     }

    <!-- error -->
     @if(!loading && errorMessage){
       <div  class="saved-jobs-state error">
         <p>{{ errorMessage }}</p>
       </div>
     }

    <!-- empty -->
     @if(!loading && !errorMessage && bookmarks.length === 0){
       <div class="saved-jobs-state empty">
         <p>لا توجد وظائف محفوظة حتى الآن.</p>
         <a routerLink="/jobseeker/jobs" class="btn btn-primary"
           >ابداء بالبحث عن وظيفة</a
         >
       </div>
     }

    <!-- list -->
    <ng-container *ngIf="!loading && !errorMessage && bookmarks.length > 0">
      @for(bm of bookmarks;track bm;){
        <div class="saved-job-item" >
          <img
            [src]="bm.job.company.logo ? baseUrl + bm.job.company.logo : 'images/company-logo-3.jpg'"
            alt="شعار الشركة"
            class="saved-job-logo"
          />
  
          <div class="saved-job-info">
            <h4 class="saved-job-title">{{ bm.job.title }}</h4>
            <p class="saved-job-company">{{ bm.job.company.name }}</p>
            <p class="saved-job-meta">
              {{ salaryText(bm.job) }} • {{ bm.job.city || bm.job.company.city }}
              • محفوظة منذ {{ bm.created_at | date: 'mediumDate' }}
            </p>
          </div>
  
          <div class="saved-job-actions" style="display: flex; gap: 0.5rem">
            <a
              [routerLink]="['/jobseeker/jobs', bm.job.slug]"
              class="btn btn-small btn-primary"
            >
              عرض
            </a>
  
            <button
              type="button"
              class="btn btn-small btn-secondary"
              (click)="removeFromSaved(bm.job)"
            >
              إزالة
            </button>
          </div>
        </div>
      }
      @if(totalPages > 1){

        <nav class="pagination-wrapper">
          <button
            class="page-btn"
            [disabled]="page === 1"
            (click)="goToPage(page - 1)"
          >
            السابق
          </button>
          @for(p of pages;track p;){
            <button
              class="page-btn"
              [class.active]="p === page"
              (click)="goToPage(p)"
            >
              {{ p }}
            </button>
          }
  
          <button
            class="page-btn"
            [disabled]="page === totalPages"
            (click)="goToPage(page + 1)"
          >
            التالي
          </button>
        </nav>
      }
    </ng-container>
  </div>
</div>
