<div id="alerts">
  <div class="dashboard-header">
    <h1 class="dashboard-title">ุชูุจููุงุช ุงููุธุงุฆู</h1>
    <div class="dashboard-actions">
      <button class="btn btn-primary" (click)="openCreateDialog()">
        ุฅูุดุงุก ุชูุจูู ุฌุฏูุฏ
      </button>
    </div>
  </div>

  <div class="content-card">
    @if (loading) {
    <div class="loading-indicator">
      <p>ุฌุงุฑู ุชุญููู ุงูุชูุจููุงุช...</p>
    </div>
    } @else if (alerts.length === 0) {
    <div class="empty-state">
      <div class="empty-state-icon">๐</div>
      <h3>ูุง ุชูุฌุฏ ุชูุจููุงุช ูุธุงุฆู</h3>
      <p>ุฃูุดุฆ ุชูุจููุงุช ููุญุตูู ุนูู ุฅุดุนุงุฑุงุช ุนูุฏ ูุดุฑ ูุธุงุฆู ุชูุงุณุจ ุงูุชูุงูุงุชู</p>
      <button class="btn btn-primary" (click)="openCreateDialog()">
        ุฅูุดุงุก ุชูุจูู ุงูุขู
      </button>
    </div>
    } @else {
    <div class="alerts-list">
      @for (alert of alerts; track alert.id) {
      <div class="alert-item" [class.inactive]="!alert.is_active">
        <div class="alert-header">
          <div class="alert-title-section">
            <h3 class="alert-title">{{ alert.title }}</h3>
            <span class="alert-status" [class.active]="alert.is_active" [class.inactive]="!alert.is_active">
              {{ alert.is_active ? 'ูุดุท' : 'ูุนุทู' }}
            </span>
          </div>
          <div class="alert-actions">
            <button class="btn-icon" (click)="toggleAlertStatus(alert)" [title]="alert.is_active ? 'ุชุนุทูู' : 'ุชูุนูู'">
              {{ alert.is_active ? 'โธ๏ธ' : 'โถ๏ธ' }}
            </button>
            <button class="btn-icon" (click)="openEditDialog(alert)" title="ุชุนุฏูู">
              <i class="pi pi-pencil"></i>
            </button>
            <button class="btn-icon btn-danger" (click)="deleteAlert(alert)" title="ุญุฐู">
              ๐๏ธ
            </button>
          </div>
        </div>
        <div class="alert-details">
          @if (alert.keywords) {
          <div class="alert-detail">
            <span class="detail-label">ุงููููุงุช ุงูููุชุงุญูุฉ:</span>
            <span class="detail-value">{{ alert.keywords }}</span>
          </div>
          }
          @if (alert.city) {
          <div class="alert-detail">
            <span class="detail-label">ุงููุฏููุฉ:</span>
            <span class="detail-value">{{ getCityLabel(alert.city) }}</span>
          </div>
          }
          @if (alert.job_type) {
          <div class="alert-detail">
            <span class="detail-label">ููุน ุงููุธููุฉ:</span>
            <span class="detail-value">{{ getJobTypeLabel(alert.job_type) }}</span>
          </div>
          }
          @if (alert.experience_level) {
          <div class="alert-detail">
            <span class="detail-label">ูุณุชูู ุงูุฎุจุฑุฉ:</span>
            <span class="detail-value">{{ getExperienceLevelLabel(alert.experience_level) }}</span>
          </div>
          }
          @if (alert.salary_min) {
          <div class="alert-detail">
            <span class="detail-label">ุงูุญุฏ ุงูุฃุฏูู ููุฑุงุชุจ:</span>
            <span class="detail-value">{{ alert.salary_min | number }} ุฑูุงู</span>
          </div>
          }
          @if (alert.category) {
          <div class="alert-detail">
            <span class="detail-label">ุงููุฆุฉ:</span>
            <span class="detail-value">{{ getCategoryName(alert.category) }}</span>
          </div>
          }
          <div class="alert-detail">
            <span class="detail-label">ุงูุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุจุฑูุฏ:</span>
            <span class="detail-value">{{ alert.email_notifications ? 'ููุนู' : 'ูุนุทู' }}</span>
          </div>
        </div>
      </div>
      }
    </div>
    }
  </div>
</div>

<!-- Create/Edit Alert Dialog -->
<p-dialog [(visible)]="showDialog" [modal]="true" [style]="{ width: '90%', maxWidth: '600px' }"
  [header]="editingAlert ? 'ุชุนุฏูู ุงูุชูุจูู' : 'ุฅูุดุงุก ุชูุจูู ุฌุฏูุฏ'" (onHide)="closeDialog()" [draggable]="false"
  [resizable]="false">
  <form [formGroup]="alertForm" (ngSubmit)="saveAlert()">
    <div class="form-group">
      <label class="form-label" for="title">ุนููุงู ุงูุชูุจูู *</label>
      <input pInputText id="title" formControlName="title" placeholder="ูุซุงู: ูุทูุฑ ุชุทุจููุงุช ุงูููุจ"
        [class.p-invalid]="alertForm.get('title')?.invalid && alertForm.get('title')?.touched" />
      @if (alertForm.get('title')?.invalid && alertForm.get('title')?.touched) {
      <small class="p-error">ุนููุงู ุงูุชูุจูู ูุทููุจ</small>
      }
    </div>

    <div class="form-group">
      <label class="form-label" for="keywords">ุงููููุงุช ุงูููุชุงุญูุฉ</label>
      <input pInputText id="keywords" formControlName="keywords" placeholder="ูุซุงู: Angular, React, Node.js" />
    </div>

    <div class="form-row">
      <div class="form-group">
        <label class="form-label" for="city">ุงููุฏููุฉ</label>
        <p-select id="city" formControlName="city" [options]="jobCities" optionLabel="label" optionValue="value"
          [showClear]="true" placeholder="ุงุฎุชุฑ ุงููุฏููุฉ"></p-select>
      </div>

      <div class="form-group">
        <label class="form-label" for="job_type">ููุน ุงููุธููุฉ</label>
        <p-select id="job_type" formControlName="job_type" [options]="jobTypes" optionLabel="label" optionValue="value"
          [showClear]="true" placeholder="ุงุฎุชุฑ ููุน ุงููุธููุฉ"></p-select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label class="form-label" for="experience_level">ูุณุชูู ุงูุฎุจุฑุฉ</label>
        <p-select id="experience_level" formControlName="experience_level" [options]="experienceLevels"
          optionLabel="label" optionValue="value" [showClear]="true" placeholder="ุงุฎุชุฑ ูุณุชูู ุงูุฎุจุฑุฉ"></p-select>
      </div>

      <div class="form-group">
        <label class="form-label" for="category">ุงููุฆุฉ</label>
        <p-select id="category" formControlName="category" [options]="categories" optionLabel="name" optionValue="id"
          [showClear]="true" placeholder="ุงุฎุชุฑ ุงููุฆุฉ"></p-select>
      </div>
    </div>

    <div class="form-group">
      <label class="form-label" for="salary_min">ุงูุญุฏ ุงูุฃุฏูู ููุฑุงุชุจ (ุฑูุงู)</label>
      <p-inputNumber id="salary_min" formControlName="salary_min" [min]="0" [useGrouping]="true"
        placeholder="ูุซุงู: 5000" styleClass="w-full"></p-inputNumber>
    </div>

    <div class="form-group checkbox-group">
      <p-checkbox formControlName="is_active" inputId="is_active" [binary]="true"></p-checkbox>
      <label for="is_active" class="checkbox-label">ุงูุชูุจูู ูุดุท</label>
    </div>

    <div class="form-group checkbox-group">
      <p-checkbox formControlName="email_notifications" inputId="email_notifications" [binary]="true"></p-checkbox>
      <label for="email_notifications" class="checkbox-label">ุงูุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
    </div>

    <div class="dialog-actions">
      <p-button type="button" label="ุฅูุบุงุก" styleClass="p-button-secondary" (onClick)="closeDialog()"></p-button>
      <p-button type="submit" label="{{ editingAlert ? 'ุชุญุฏูุซ' : 'ุฅูุดุงุก' }}" styleClass="p-button-primary"
        [disabled]="alertForm.invalid"></p-button>
    </div>
  </form>
</p-dialog>