<div id="applications">
  <!-- Header Skeleton -->
  @if (isLoading) {
  <div class="dashboard-header">
    <p-skeleton width="150px" height="2rem" styleClass="skeleton-title"></p-skeleton>
    <p-skeleton width="200px" height="2.5rem" styleClass="skeleton-button"></p-skeleton>
  </div>
  } @else {
  <div class="dashboard-header">
    <h1 class="dashboard-title">طلباتي</h1>
    <div class="dashboard-actions">
      <a routerLink="/jobseeker/jobs" class="btn btn-primary">البحث عن وظائف جديدة</a>
    </div>
  </div>
  }

  <div class="content-card">
    <!-- Tab Navigation Skeleton -->
    @if (isLoading) {
    <div class="tab-navigation">
      @for (tab of [1,2,3,4,5]; track tab) {
      <p-skeleton width="120px" height="3rem" styleClass="skeleton-tab"></p-skeleton>
      }
    </div>
    } @else {
    <div class="tab-navigation">
      <button
        class="tab"
        [class.active]="activeTab === 'all'"
        (click)="setActiveTab('all')"
      >
        جميع الطلبات ({{ statusCounts.all }})
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'pending'"
        (click)="setActiveTab('pending')"
      >
        قيد المراجعة ({{ statusCounts.pending }})
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'reviewed'"
        (click)="setActiveTab('reviewed')"
      >
        تمت المراجعة ({{ statusCounts.reviewed }})
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'accepted'"
        (click)="setActiveTab('accepted')"
      >
        مقبولة ({{ statusCounts.accepted }})
      </button>
      <button
        class="tab"
        [class.active]="activeTab === 'rejected'"
        (click)="setActiveTab('rejected')"
      >
        مرفوضة ({{ statusCounts.rejected }})
      </button>
    </div>
    }

    @if (isLoading) {
    <!-- Applications List Skeleton -->
    <div class="applications-list">
      @for (item of [1,2,3]; track item) {
      <div class="application-item skeleton-application-item">
        <p-skeleton width="80px" height="80px" shape="circle" styleClass="skeleton-logo"></p-skeleton>
        <div class="application-info skeleton-application-info">
          <p-skeleton width="200px" height="1.5rem" styleClass="mb-2"></p-skeleton>
          <p-skeleton width="150px" height="1.2rem" styleClass="mb-2"></p-skeleton>
          <div class="skeleton-meta-container">
            <p-skeleton width="120px" height="1rem"></p-skeleton>
            <p-skeleton width="80px" height="1rem"></p-skeleton>
            <p-skeleton width="100px" height="1rem"></p-skeleton>
          </div>
        </div>
        <p-skeleton width="80px" height="2rem" styleClass="skeleton-status"></p-skeleton>
      </div>
      }
    </div>
    } @else if (filteredApplications.length === 0) {
    <div class="empty-state">
      <p>لا توجد طلبات في هذه الفئة.</p>
      <a routerLink="/jobseeker/jobs" class="btn btn-primary">البحث عن وظائف جديدة</a>
    </div>
    } @else {
    <div class="applications-list">
      @for (application of filteredApplications; track application.id) {
      <div class="application-item">
        <img
          [src]="getCompanyLogo(application.job.company.logo)"
          [alt]="application.job.company.name"
          class="application-logo"
          title="شعار الشركة"
        />
        <div class="application-info">
          <h4 class="application-title">
            <a
              [routerLink]="['/jobs/job-details', application.job.slug]"
              class="application-title-link"
            >
              {{ application.job.title }}
            </a>
          </h4>
          <p class="application-company">
            <a
              [routerLink]="['/company', application.job.company.slug]"
              class="company-link"
            >
              {{ application.job.company.name }}
            </a>
          </p>
          <div class="application-meta">
            <span>تقدمت في {{ formatDate(application.applied_at) }}</span>
            <span>{{ cityLabel(application.job.city) }}</span>
            <span>
              {{ formatSalary(application.job.salary_min, application.job.salary_max) }}
            </span>
          </div>
        </div>
        <span
          class="application-status"
          [ngClass]="getStatusClass(application.status)"
        >
          {{ getStatusLabel(application.status) }}
        </span>
      </div>
      }
    </div>
    }
  </div>
</div>
