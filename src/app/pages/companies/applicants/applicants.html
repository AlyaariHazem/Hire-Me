<div id="applicants" class="applicants-container">
  <div class="employer-header">
    <div>
      <h1 class="employer-title">Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙˆÙ† Ù„Ù„ÙˆØ¸ÙŠÙØ©</h1>
      @if (jobTitle) {
        <p class="job-title">{{ jobTitle }}</p>
      }
    </div>
    <div class="employer-actions">
      <a [routerLink]="['/companies/manage-jobs']" class="btn btn-secondary">
        Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
      </a>
    </div>
  </div>

  <div class="employer-content-card">
    <!-- Status Filter Tabs -->
    <div class="tab-navigation">
      <button 
        class="tab" 
        [class.active]="statusFilter === 'all'"
        (click)="setStatusFilter('all')">
        Ø§Ù„ÙƒÙ„ ({{ statusCounts.all }})
      </button>
      <button 
        class="tab" 
        [class.active]="statusFilter === 'pending'"
        (click)="setStatusFilter('pending')">
        Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ({{ statusCounts.pending }})
      </button>
      <button 
        class="tab" 
        [class.active]="statusFilter === 'reviewed'"
        (click)="setStatusFilter('reviewed')">
        ØªÙ… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ({{ statusCounts.reviewed }})
      </button>
      <button 
        class="tab" 
        [class.active]="statusFilter === 'accepted'"
        (click)="setStatusFilter('accepted')">
        Ù…Ù‚Ø¨ÙˆÙ„ ({{ statusCounts.accepted }})
      </button>
      <button 
        class="tab" 
        [class.active]="statusFilter === 'rejected'"
        (click)="setStatusFilter('rejected')">
        Ù…Ø±ÙÙˆØ¶ ({{ statusCounts.rejected }})
      </button>
    </div>

    <!-- Loading State -->
    @if (loading) {
      <div class="tab-content">
        <div class="skeleton"></div>
      </div>
    }

    <!-- Empty State -->
    @if (!loading && filteredApplications.length === 0) {
      <div class="tab-content">
        <div class="empty">
          <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</p>
        </div>
      </div>
    }

    <!-- Applications List -->
    @if (!loading && filteredApplications.length > 0) {
      <div class="tab-content">
        @for (app of filteredApplications; track app.id) {
          <div class="application-item">
            <div class="application-info">
              <div class="candidate-header">
                <div class="candidate-avatar">
                  @if (app.applicant?.user?.profile_picture) {
                    <img 
                      [src]="app.applicant!.user!.profile_picture!" 
                      [alt]="getApplicantName(app)"
                      [title]="getApplicantName(app)"
                      (error)="handleImageError($event)">
                  }
                  <span [style.display]="app.applicant?.user?.profile_picture ? 'none' : 'flex'">
                    {{ getApplicantInitials(app) }}
                  </span>
                </div>
                <div class="candidate-details">
                  <h4 class="candidate-name">
                    {{ getApplicantName(app) }}
                  </h4>
                  @if (app.applicant?.experience_level) {
                    <p class="candidate-title">
                      Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø¨Ø±Ø©: {{ app.applicant!.experience_level }}
                    </p>
                  }
                  @if (app.applicant?.education_level) {
                    <p class="candidate-title">
                      Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ: {{ app.applicant!.education_level }}
                    </p>
                  }
                  <div class="candidate-meta">
                    <span>ğŸ“§ {{ app.applicant?.user?.email || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
                    <span>ğŸ“… {{ formatDate(app.created_at) }}</span>
                  </div>
                  @if (app.applicant?.skills) {
                    <div class="candidate-skills">
                      @for (skill of getSkillsList(app.applicant!.skills); track skill) {
                        <span class="skill-tag">{{ skill }}</span>
                      }
                    </div>
                  }
                </div>
              </div>
            </div>

            <div class="application-actions">
              <span 
                class="application-status" 
                [ngClass]="getStatusClass(app.status)">
                {{ getStatusLabel(app.status) }}
              </span>
              <div class="action-buttons">
                <button 
                  class="btn btn-small btn-primary"
                  (click)="viewApplication(app)">
                  Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                </button>
                @if (app.applicant?.resume) {
                  <button 
                    class="btn btn-small btn-secondary"
                    (click)="downloadResume(app)">
                    ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©
                  </button>
                }
              </div>
              @if (app.status === 'pending') {
                <div class="status-actions">
                  <button 
                    class="btn btn-small btn-success"
                    (click)="updateApplicationStatus(app.id, 'accepted')">
                    Ù‚Ø¨ÙˆÙ„
                  </button>
                  <button 
                    class="btn btn-small btn-danger"
                    (click)="updateApplicationStatus(app.id, 'rejected')">
                    Ø±ÙØ¶
                  </button>
                </div>
              }
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>

