<!-- Overview Tab -->
<div id="overview" class="tab-content active">
  <!-- Header Skeleton -->
  @if (loadingJobs() || loadingApplications()) {
  <div class="employer-header">
    <p-skeleton width="250px" height="2rem" styleClass="skeleton-title"></p-skeleton>
    <div class="employer-actions">
      <p-skeleton width="180px" height="2.5rem" styleClass="skeleton-button"></p-skeleton>
      <p-skeleton width="180px" height="2.5rem" styleClass="skeleton-button"></p-skeleton>
    </div>
  </div>
  } @else {
  <div class="employer-header">
    <h1 class="employer-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
    <div class="employer-actions">
      <a routerLink="/companies/post-job" class="btn btn-primary">Ù†Ø´Ø± ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©</a>
      <a routerLink="/companies/applicants" class="btn btn-secondary"
        >Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø±Ø´Ø­ÙŠÙ†</a
      >
    </div>
  </div>
  }

  <!-- Stats Grid Skeleton -->
  @if (loadingJobs() || loadingApplications()) {
  <div class="employer-stats-grid">
    @for (item of [1,2,3,4]; track item) {
    <div class="employer-stat-card">
      <div class="employer-stat-header">
        <p-skeleton width="120px" height="1.2rem" styleClass="mb-0"></p-skeleton>
        <p-skeleton width="30px" height="30px" shape="circle" styleClass="mb-0"></p-skeleton>
      </div>
      <p-skeleton width="80px" height="2.5rem" styleClass="mb-2"></p-skeleton>
      <p-skeleton width="100px" height="1rem"></p-skeleton>
    </div>
    }
  </div>
  }

  <!-- Stats Grid -->
  @if (!loadingJobs() && !loadingApplications()) {
  <div class="employer-stats-grid">
    <div class="employer-stat-card">
      <div class="employer-stat-header">
        <span class="employer-stat-title">Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù†Ø´Ø·Ø©</span>
        <span class="employer-stat-icon">ğŸ’¼</span>
      </div>
      <div class="employer-stat-value">{{ activeJobsThisMonth() }}</div>
      <div class="employer-stat-change">
        @if (getJobsAddedThisMonth() > 0) {
          +{{ getJobsAddedThisMonth() }} Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
        } @else if (getJobsAddedThisMonth() < 0) {
          {{ getJobsAddedThisMonth() }} Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±
        } @else {
          Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±
        }
      </div>
    </div>

    <div class="employer-stat-card">
      <div class="employer-stat-header">
        <span class="employer-stat-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†</span>
        <span class="employer-stat-icon">ğŸ‘¥</span>
      </div>
      <div class="employer-stat-value">{{ totalApplicantsThisWeek() }}</div>
      <div class="employer-stat-change">Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
    </div>

    <div class="employer-stat-card">
      <div class="employer-stat-header">
        <span class="employer-stat-title">Ù…ØªÙ‚Ø¯Ù…ÙˆÙ† Ø¬Ø¯Ø¯</span>
        <span class="employer-stat-icon">ğŸ†•</span>
      </div>
      <div class="employer-stat-value">{{ newApplicantsToday() }}</div>
      <div class="employer-stat-change">Ø§Ù„ÙŠÙˆÙ…</div>
    </div>

    <div class="employer-stat-card">
      <div class="employer-stat-header">
        <span class="employer-stat-title">Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</span>
        <span class="employer-stat-icon">ğŸ‘ï¸</span>
      </div>
      <div class="employer-stat-value">{{ totalJobViews().toLocaleString() }}</div>
      <div class="employer-stat-change">{{ getViewsChangeText() }}</div>
    </div>
  </div>
  }

  <!-- Quick Actions Skeleton -->
  @if (loadingJobs() || loadingApplications()) {
  <div class="quick-actions-grid">
    @for (item of [1,2,3,4]; track item) {
    <div class="quick-action-employer skeleton-quick-action">
      <p-skeleton width="60px" height="60px" shape="circle" styleClass="mb-2"></p-skeleton>
      <p-skeleton width="80%" height="1.5rem" styleClass="mb-2"></p-skeleton>
      <p-skeleton width="100%" height="1rem"></p-skeleton>
    </div>
    }
  </div>
  }

  <!-- Quick Actions -->
  @if (!loadingJobs() && !loadingApplications()) {
  <div class="quick-actions-grid">
    <a routerLink="/companies/post-job" class="quick-action-employer">
      <div class="quick-action-employer-icon">â•</div>
      <h3 class="quick-action-employer-title">Ù†Ø´Ø± ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
      <p class="quick-action-employer-desc">
        Ø£Ø¶Ù ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ§Ø¬Ø°Ø¨ Ø£ÙØ¶Ù„ Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨
      </p>
    </a>

    <a routerLink="/companies/applicants" class="quick-action-employer">
      <div class="quick-action-employer-icon">ğŸ”</div>
      <h3 class="quick-action-employer-title">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø±Ø´Ø­ÙŠÙ†</h3>
      <p class="quick-action-employer-desc">Ø§Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ†</p>
    </a>

    <a routerLink="/companies/profile" class="quick-action-employer">
      <div class="quick-action-employer-icon">ğŸ¢</div>
      <h3 class="quick-action-employer-title">ØªØ­Ø¯ÙŠØ« Ù…Ù„Ù Ø§Ù„Ø´Ø±ÙƒØ©</h3>
      <p class="quick-action-employer-desc">Ø­Ø¯Ø« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØµÙˆØ± Ø§Ù„Ø´Ø±ÙƒØ©</p>
    </a>

    <a
      href="#analytics"
      class="quick-action-employer"
      onclick="switchEmployerTab('analytics')"
    >
      <div class="quick-action-employer-icon">ğŸ“Š</div>
      <h3 class="quick-action-employer-title">Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</h3>
      <p class="quick-action-employer-desc">ØªØ§Ø¨Ø¹ Ø£Ø¯Ø§Ø¡ ÙˆØ¸Ø§Ø¦ÙÙƒ ÙˆØ¥Ø¹Ù„Ø§Ù†Ø§ØªÙƒ</p>
    </a>
  </div>
  }

  <!-- Content Grid -->
  <div class="employer-content-grid">
    <!-- Recent Job Postings -->
    <div class="employer-content-card">
      @if (loadingJobs()) {
      <div class="card-header">
        <p-skeleton width="200px" height="1.5rem" styleClass="skeleton-card-title"></p-skeleton>
        <p-skeleton width="80px" height="1.2rem" styleClass="skeleton-card-action"></p-skeleton>
      </div>
      } @else {
      <div class="card-header">
        <h2 class="card-title">Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø© Ù…Ø¤Ø®Ø±Ø§Ù‹</h2>
        <a 
          (click)="viewAllJobs()"
          class="card-action clickable"
          >Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a
        >
      </div>
      }

      @if (loadingJobs()) {
        <div class="jobs-skeleton">
          @for (item of [1,2,3]; track item) {
          <div class="job-posting-item">
            <div class="job-posting-info">
              <p-skeleton width="60%" height="1.5rem" styleClass="mb-2"></p-skeleton>
              <div class="job-posting-meta">
                <p-skeleton width="100px" height="1rem" styleClass="mb-0"></p-skeleton>
                <p-skeleton width="80px" height="1rem" styleClass="mb-0"></p-skeleton>
                <p-skeleton width="120px" height="1rem" styleClass="mb-0"></p-skeleton>
              </div>
              <div class="job-posting-stats">
                <p-skeleton width="80px" height="1rem" styleClass="mb-0"></p-skeleton>
                <p-skeleton width="80px" height="1rem" styleClass="mb-0"></p-skeleton>
                <p-skeleton width="100px" height="1rem" styleClass="mb-0"></p-skeleton>
              </div>
            </div>
            <p-skeleton width="80px" height="2rem" styleClass="mb-0"></p-skeleton>
          </div>
          }
        </div>
      } @else if (recentJobs().length === 0) {
        <div class="empty-state">
          <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ù…Ù†Ø´ÙˆØ±Ø©</p>
        </div>
      } @else {
        @for (job of recentJobs(); track job.id) {
          <div class="job-posting-item">
            <div class="job-posting-info">
              <h4 class="job-posting-title">{{ job.title }}</h4>
              <div class="job-posting-meta">
                <span>Ù†ÙØ´Ø±Øª {{ getTimeAgoForJob(job.created_at) }}</span>
                <span>{{ job.city || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</span>
                <span>{{ formatSalaryRange(job) }}</span>
              </div>
              <div class="job-posting-stats">
                <span>{{ job.applications_count || 0 }} Ù…ØªÙ‚Ø¯Ù…</span>
                <span>{{ job.views_count || 0 }} Ù…Ø´Ø§Ù‡Ø¯Ø©</span>
                @if (job.category) {
                  <span>{{ job.category.name }}</span>
                }
              </div>
            </div>
            <span 
              class="job-status" 
              [ngClass]="getJobStatusClass(job)">
              {{ getJobStatusLabel(job) }}
            </span>
          </div>
        }
      }
    </div>

    <!-- Recent Candidates -->
    <div class="employer-content-card">
      @if (loadingApplications()) {
      <div class="card-header">
        <p-skeleton width="150px" height="1.5rem" styleClass="skeleton-card-title"></p-skeleton>
        <p-skeleton width="80px" height="1.2rem" styleClass="skeleton-card-action"></p-skeleton>
      </div>
      } @else {
      <div class="card-header">
        <h2 class="card-title">Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙˆÙ† Ø§Ù„Ø¬Ø¯Ø¯</h2>
        <a
          (click)="viewAllApplicants()"
          class="card-action clickable"
          >Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</a
        >
      </div>
      }

      @if (loadingApplications()) {
        <div class="applications-skeleton">
          @for (item of [1,2,3,4]; track item) {
          <div class="candidate-item">
            <p-skeleton width="50px" height="50px" shape="circle" styleClass="skeleton-avatar"></p-skeleton>
            <div class="candidate-info">
              <p-skeleton width="60%" height="1.3rem" styleClass="mb-2"></p-skeleton>
              <p-skeleton width="50%" height="1rem" styleClass="mb-2"></p-skeleton>
              <div class="candidate-meta">
                <p-skeleton width="120px" height="1rem" styleClass="mb-0"></p-skeleton>
                <p-skeleton width="150px" height="1rem" styleClass="mb-0"></p-skeleton>
              </div>
            </div>
            <div class="candidate-actions">
              <p-skeleton width="80px" height="1.5rem" styleClass="mb-2"></p-skeleton>
              <p-skeleton width="100px" height="2rem" styleClass="mb-0"></p-skeleton>
            </div>
          </div>
          }
        </div>
      } @else if (recentApplications().length === 0) {
        <div class="empty-state">
          <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</p>
        </div>
      } @else {
        @for (app of recentApplications(); track app.id) {
          <div class="candidate-item">
            <div class="candidate-avatar">
              @if (app.applicant?.profile_picture) {
                <img
                  [src]="app.applicant?.profile_picture || ''"
                  [alt]="getApplicantName(app)"
                  [title]="getApplicantName(app)"
                  title="Applicant profile picture"
                  (error)="handleImageError($event)"
                />
              }
              <span [style.display]="app.applicant?.profile_picture ? 'none' : 'flex'">
                {{ getApplicantInitials(app) }}
              </span>
            </div>
            <div class="candidate-info">
              <h4 class="candidate-name">{{ getApplicantName(app) }}</h4>
              <p class="candidate-title">{{ getApplicantTitle(app) }}</p>
              <div class="candidate-meta">
                <span>ØªÙ‚Ø¯Ù… {{ getTimeAgo(app.applied_at) }}</span>
                @if (app.job.title) {
                  <span>{{ app.job.title }}</span>
                }
              </div>
            </div>
            <div class="candidate-actions">
              <span 
                class="application-status" 
                [ngClass]="getStatusClass(app.status)">
                {{ getStatusLabel(app.status) }}
              </span>
              <button 
                class="btn btn-small btn-primary"
                (click)="viewApplicantProfile(app)">
                Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù
              </button>
            </div>
          </div>
        }
      }
    </div>
  </div>
</div>
