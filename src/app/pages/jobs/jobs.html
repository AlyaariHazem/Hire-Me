<section class="search-page-header">
      <div class="container">
        <form
          class="search-form"
          style="max-width: 100%; margin: 0"
          (ngSubmit)="onSearchSubmit()"
        >
          <div class="search-fields">
            <div class="field-group">
              <input
                type="text"
                id="job-title"
                class="form-input"
                placeholder="ุนููุงู ุงููุธููุฉ ุฃู ุงููููุงุช ุงูููุชุงุญูุฉ"
                name="search"
                [(ngModel)]="filters.search"
              />
            </div>

            <div class="field-group">
              <select
                id="location"
                class="form-select"
                name="city"
                [(ngModel)]="filters.city"
                (change)="onCityChange(filters.city || '')"
              >
                <option value="">ุฌููุน ุงูููุงูุน</option>
                <option value="sanaa">ุตูุนุงุก</option>
                <option value="aden">ุนุฏู</option>
                <option value="taiz">ุชุนุฒ</option>
                <option value="hodeidah">ุงูุญุฏูุฏุฉ</option>
                <option value="ibb">ุฅุจ</option>
                <option value="mukalla">ุงููููุง</option>
                <option value="remote">ุนูู ุนู ุจูุนุฏ</option>
              </select>
            </div>

            <div class="field-group">
              <!-- ููุง ููุถูู ูุงุญูุงู ุชุนุจูู ุงูุฎูุงุฑุงุช ูู getCategories() ูุชุฎูู value=id -->
              <select
                id="category"
                class="form-select"
                name="category"
                [(ngModel)]="filters.category"
                (change)="onCategoryChange(filters.category)"
              >
                <option [ngValue]="undefined">ุฌููุน ุงููุฆุงุช</option>
                <option [ngValue]="1">ุชูููุฉ ุงููุนูููุงุช</option>
                <option [ngValue]="2">ุงูููุฏุณุฉ</option>
                <option [ngValue]="3">ุงูุชุณููู</option>
                <!-- ุงูุฎ... ูู ุงูู backend ูุงุญูุงู -->
              </select>
            </div>
          </div>

          <button type="submit" class="btn btn-primary search-btn">
            <span class="icon-search"></span>
            ุจุญุซ
          </button>
        </form>
      </div>
    </section>
    <section class="search-results-section">
      <div class="container">
        <div class="search-results-container">
          <!-- Filters Sidebar -->
          <aside class="filters-sidebar">
            <div class="filter-section">
              <h3 class="filter-title">ููุน ุงููุธููุฉ</h3>
              <div class="filter-options">
                <div
                  class="filter-option"
                  (click)="setJobType('full_time')"
                  [class.active]="filters.job_type === 'full_time'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ุฏูุงู ูุงูู</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(234)</span
                  >
                </div>

                <div
                  class="filter-option"
                  (click)="setJobType('part_time')"
                  [class.active]="filters.job_type === 'part_time'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ุฏูุงู ุฌุฒุฆู</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(89)</span
                  >
                </div>

                <div
                  class="filter-option"
                  (click)="setJobType('contract')"
                  [class.active]="filters.job_type === 'contract'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ุนูุฏ ูุคูุช</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(45)</span
                  >
                </div>

                <div
                  class="filter-option"
                  (click)="setJobType('freelance')"
                  [class.active]="filters.job_type === 'freelance'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ุนูู ุนู ุจูุนุฏ</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(67)</span
                  >
                </div>
              </div>
            </div>

            <!-- ูุณุชูู ุงูุฎุจุฑุฉ -->
            <div class="filter-section">
              <h3 class="filter-title">ูุณุชูู ุงูุฎุจุฑุฉ</h3>
              <div class="filter-options">
                <div
                  class="filter-option"
                  (click)="setExperienceLevel('entry')"
                  [class.active]="filters.experience_level === 'entry'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ูุจุชุฏุฆ (0-2 ุณูุฉ)</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(156)</span
                  >
                </div>

                <div
                  class="filter-option"
                  (click)="setExperienceLevel('mid')"
                  [class.active]="filters.experience_level === 'mid'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ูุชูุณุท (3-5 ุณููุงุช)</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(198)</span
                  >
                </div>

                <div
                  class="filter-option"
                  (click)="setExperienceLevel('senior')"
                  [class.active]="filters.experience_level === 'senior'"
                >
                  <div class="filter-checkbox"></div>
                  <span>ุฎุจูุฑ (6+ ุณููุงุช)</span>
                  <span style="margin-right: auto; color: var(--gray-500)"
                    >(89)</span
                  >
                </div>
              </div>
            </div>

            <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem">
              <button
                class="btn btn-small btn-primary"
                (click)="applyFilters()"
              >
                ุชุทุจูู
              </button>
              <button
                class="btn btn-small btn-secondary"
                (click)="clearAllFilters()"
              >
                ูุณุญ ุงููู
              </button>
            </div>
          </aside>

          <!-- Results Content -->
          <main class="results-content">
            <div class="results-header">
              <div class="results-count">
                <strong>{{ totalJobs }} ูุธููุฉ</strong>
                ุชุทุงุจู ุจุญุซู
              </div>

              <div class="sort-dropdown">
                <label for="sort">ุชุฑุชูุจ ุญุณุจ:</label>
                <select
                  id="sort"
                  class="form-select"
                  style="width: auto"
                  [(ngModel)]="sortValue"
                  (ngModelChange)="onSortChange($event)"
                  name="sort"
                >
                  <option value="relevance">ุงูุฃูุซุฑ ุตูุฉ</option>
                  <option value="date">ุงูุฃุญุฏุซ</option>
                  <option value="salary">ุงูุฑุงุชุจ</option>
                  <option value="company">ุงุณู ุงูุดุฑูุฉ</option>
                </select>
              </div>
            </div>

            <div class="job-results">
              @for(job of jobs; track job){
                <article
                  class="job-card-horizontal"
                  [attr.data-job-id]="job.id"
                >
                  <img
                    [src]="job.company.logo || 'assets/images/company-placeholder.png'"
                    alt="ุดุนุงุฑ ุงูุดุฑูุฉ"
                    class="company-logo"
                  />
  
                  <div class="job-info">
                    <h3 class="job-title">
                      <a
                        [routerLink]="['/jobs', job.slug]"
                        style="text-decoration: none; color: inherit"
                      >
                        {{ job.title }}
                      </a>
                    </h3>
  
                    <p class="company-name">{{ job.company.name || '-' }}</p>
  
                    <!-- meta row like your screenshot -->
                    <div class="job-meta">
                      <span>๐ {{ cityLabel(job.city) }}</span>
                      <span>๐ฅ {{ formatSalary(job) }}</span>
                      <span>โฐ {{ jobTypeLabel(job.job_type) }}</span>
                      <span>๐ {{ timeAgo(job.created_at) }}</span>
                    </div>
  
                    <!-- description (if API sends it) -->
                     @if(job.description){
                       <p
                         class="job-description"
                       >
                         {{ job.description }}
                       </p>
                     }
  
                    <!-- fallback short line if no description -->
                     @if(!job.description){
                       <p
                         class="job-description"
                       >
                         {{ job.category.name || '-' }} โข {{ job.company.city || '-' }}
                       </p>
                     }
  
                    <!-- tags row -->
                    <div class="job-tags">
                      <span class="job-tag">{{ jobTypeLabel(job.job_type) }}</span>
                      <span class="job-tag">{{ job.experience_level }}</span>
                      <span class="job-tag">{{ job.category.name || '-' }}</span>
                      <span class="job-tag">{{ cityLabel(job.city) }}</span>
                    </div>
                  </div>
  
                  <div
                    class="job-actions"
                    style="display: flex; flex-direction: column; gap: 0.5rem"
                  >
                    <button
                      class="btn btn-small btn-secondary save-btn"
                      [class.active]="job.is_applied"
                      [class.loading]="applyingJobs.has(job.id)"
                      [disabled]="job.is_applied || applyingJobs.has(job.id)"
                      (click)="applyToJob(job)"
                    >
                      @if (applyingJobs.has(job.id)) {
                        ุฌุงุฑู ุงูุชูุฏูู...
                      } @else if (job.is_applied) {
                        ุชู ุงูุชูุฏูู
                      } @else {
                        ุชูุฏูู ุงูุขู
                      }
                    </button>
  
                    <button
                      class="btn btn-small btn-secondary save-btn"
                      [ngClass]="job.is_bookmarked ? 'active' : ''"
                      (click)="saveJob(job)"
                    >
                      {{ job.is_bookmarked ? 'ูุญููุธ' : 'ุญูุธ' }}
                    </button>
  
                    <button
                      class="btn btn-small btn-secondary"
                      (click)="shareJob(job.id, job.title)"
                    >
                      ูุดุงุฑูุฉ
                    </button>
                  </div>
                </article>
              }


              <!-- ูู ุญุงูุฉ ูุง ูู ูุธุงุฆู -->
               @if(jobs.length === 0){
                 <div
                   style="padding: 1rem; text-align: center"
                 >
                   ูุง ุชูุฌุฏ ูุธุงุฆู ูุทุงุจูุฉ ุญุงููุงู.
                 </div>
               }
            </div>

            <!-- Pagination -->
            <nav class="pagination" *ngIf="totalPages > 1">
              <button
                class="pagination-btn"
                (click)="previousPage()"
                [disabled]="currentPage === 1"
                type="button"
              >
                ุงูุณุงุจู
              </button>
              @for(p of pages; track p){
                <button
                  class="pagination-btn"
                  [class.current]="p === currentPage"
                  (click)="goToPage(p)"
                  type="button"
                >
                  {{ p }}
                </button>
              }

              <button
                class="pagination-btn"
                (click)="nextPage()"
                [disabled]="currentPage === totalPages"
                type="button"
              >
                ุงูุชุงูู
              </button>
            </nav>

            <!-- Load More Button (Alternative to pagination) -->
            <div class="text-center" style="margin-top: 2rem; display: none">
              <button class="btn btn-secondary load-more-btn">
                ุชุญููู ุงููุฒูุฏ ูู ุงููุธุงุฆู
              </button>
            </div>
          </main>
        </div>
      </div>
    </section>