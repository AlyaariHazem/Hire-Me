
<!-- Hero Section -->
<section class="companies-hero">
  <div class="container">
    <h1>Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ø´Ø±ÙƒØ§Øª</h1>
    <p>ØªØµÙØ­ Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø±Ø§Ø¦Ø¯Ø© ÙÙŠ Ø§Ù„ÙŠÙ…Ù† ÙˆØ§ÙƒØªØ´Ù Ø§Ù„ÙØ±Øµ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©</p>

    <div class="companies-search">
      <p-iconfield iconPosition="left">
        <p-inputicon>
          <i class="pi pi-search"></i>
        </p-inputicon>
        <input 
          type="text" 
          pInputText 
          placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø´Ø±ÙƒØ§Øª..." 
          [(ngModel)]="searchTerm" 
          (input)="applyFilters()"
          class="w-full"
        />
      </p-iconfield>
      <p-button 
        label="Ø¨Ø­Ø«" 
        icon="pi pi-search" 
        (onClick)="applyFilters()"
        styleClass="p-button-primary"
      ></p-button>
    </div>
  </div>
</section>

<!-- Filters -->
<section class="companies-filters">
  <div class="container">
    <div class="filters-container">
      <div class="filter-group">
        <label>Ø§Ù„Ù‚Ø·Ø§Ø¹:</label>
        <p-select
          [options]="industryOptions"
          [(ngModel)]="industryFilter"
          optionLabel="label"
          optionValue="value"
          placeholder="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª"
          (onChange)="applyFilters()"
          [showClear]="true"
          styleClass="w-full"
        ></p-select>
      </div>

      <div class="filter-group">
        <label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label>
        <p-select
          [options]="cityOptions"
          [(ngModel)]="locationFilter"
          optionLabel="label"
          optionValue="value"
          placeholder="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯Ù†"
          (onChange)="applyFilters()"
          [showClear]="true"
          styleClass="w-full"
        ></p-select>
      </div>

      <div class="filter-group">
        <label>Ø­Ø¬Ù… Ø§Ù„Ø´Ø±ÙƒØ©:</label>
        <p-select
          [options]="sizeOptions"
          [(ngModel)]="sizeFilter"
          optionLabel="label"
          optionValue="value"
          placeholder="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø­Ø¬Ø§Ù…"
          (onChange)="applyFilters()"
          [showClear]="true"
          styleClass="w-full"
        ></p-select>
      </div>

      <p-button 
        label="ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±" 
        icon="pi pi-filter" 
        (onClick)="applyFilters()"
        styleClass="p-button-primary"
      ></p-button>
    </div>
  </div>
</section>

<!-- Stats -->
<section class="companies-stats">
  <div class="container">
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-number">
          @if (loadingStats) {
            <p-skeleton width="60px" height="2rem"></p-skeleton>
          } @else {
            {{ statistics.totalCompanies }}+
          }
        </div>
        <div class="stat-label">Ø´Ø±ÙƒØ© Ù…Ø³Ø¬Ù„Ø©</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">
          @if (loadingStats) {
            <p-skeleton width="80px" height="2rem"></p-skeleton>
          } @else {
            {{ statistics.totalJobs | number }}+
          }
        </div>
        <div class="stat-label">ÙˆØ¸ÙŠÙØ© Ù…ØªØ§Ø­Ø©</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">
          @if (loadingStats) {
            <p-skeleton width="40px" height="2rem"></p-skeleton>
          } @else {
            {{ statistics.totalSectors }}
          }
        </div>
        <div class="stat-label">Ù‚Ø·Ø§Ø¹ Ù…Ø®ØªÙ„Ù</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">
          @if (loadingStats) {
            <p-skeleton width="40px" height="2rem"></p-skeleton>
          } @else {
            {{ statistics.totalGovernorates }}
          }
        </div>
        <div class="stat-label">Ù…Ø­Ø§ÙØ¸Ø©</div>
      </div>
    </div>
  </div>
</section>

<!-- Featured Companies -->
<!-- @if (featuredCompanies.length > 0) {
  <section class="featured-companies">
    <div class="container">
      <h2 class="featured-title">Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
      <div class="featured-grid">
        @for (company of featuredCompanies; track company.id || company.slug) {
          <div class="featured-company" (click)="viewCompany(company.slug || company.id)">
            <img
              [src]="company.logo"
              [alt]="company.name"
              [title]="company.name"
              class="featured-logo"
              (error)="handleImageError($event)"
            />
            <div class="featured-name">{{ company.name }}</div>
            <div class="featured-jobs">{{ company.openJobs }} ÙˆØ¸Ø§Ø¦Ù Ù…ØªØ§Ø­Ø©</div>
          </div>
        }
      </div>
    </div>
  </section>
} -->

<!-- Loading State -->
@if (loading) {
  <section class="companies-section">
    <div class="container">
      <div class="loading-state">
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ø±ÙƒØ§Øª...</p>
      </div>
      <div class="companies-grid">
        @for (item of [1,2,3,4,5,6]; track item) {
          <p-card styleClass="company-card-skeleton">
            <div class="skeleton-content">
              <p-skeleton width="80px" height="80px" shape="circle"></p-skeleton>
              <div class="skeleton-text">
                <p-skeleton width="60%" height="1.5rem" styleClass="mb-2"></p-skeleton>
                <p-skeleton width="40%" height="1rem"></p-skeleton>
              </div>
            </div>
            <p-skeleton width="100%" height="3rem" styleClass="mb-2"></p-skeleton>
            <p-skeleton width="100%" height="3rem"></p-skeleton>
          </p-card>
        }
      </div>
    </div>
  </section>
}

<!-- Companies Grid -->
@if (!loading && companiesData.length > 0) {
  <section class="companies-section">
    <div class="container">
      <div class="companies-grid">
        @for (company of companiesData; track company.id || company.slug) {
          <p-card 
            styleClass="company-card"
            (click)="viewCompany(company.slug || company.id)"
            [style.cursor]="'pointer'"
          >
            <div class="company-header">
              <div class="company-info">
                <img 
                  [src]="company.logo" 
                  [alt]="company.name"
                  [title]="company.name"
                  class="company-logo"
                  (error)="handleImageError($event)"
                >
                <div class="company-details">
                  <h3>{{ company.name }}</h3>
                  <p-tag [value]="company.industry" severity="info" styleClass="mb-2"></p-tag>
                  <div class="company-location">ğŸ“ {{ company.location }}</div>
                </div>
              </div>
            </div>

            <div class="company-body">
              <p class="company-description">{{ company.description }}</p>
              @if (company.tags && company.tags.length > 0) {
                <div class="company-tags">
                  @for (tag of company.tags; track tag) {
                    <p-tag [value]="tag" severity="secondary"></p-tag>
                  }
                </div>
              }

              <div class="company-stats-row">
                @if (company.employees) {
                  <div class="company-stat">
                    <div class="company-stat-number">{{ company.employees }}</div>
                    <div class="company-stat-label">Ù…ÙˆØ¸Ù</div>
                  </div>
                }
                <div class="company-stat">
                  <div class="company-stat-number">{{ company.openJobs }}</div>
                  <div class="company-stat-label">ÙˆØ¸ÙŠÙØ© Ù…ØªØ§Ø­Ø©</div>
                </div>
                @if (company.followers > 0) {
                  <div class="company-stat">
                    <div class="company-stat-number">{{ company.followers }}</div>
                    <div class="company-stat-label">Ù…ØªØ§Ø¨Ø¹</div>
                  </div>
                }
              </div>

              <div class="company-actions" (click)="$event.stopPropagation()">
                <p-button
                  [label]="company.following ? 'Ù…ØªØ§Ø¨Ø¹' : 'Ù…ØªØ§Ø¨Ø¹Ø©'"
                  [icon]="company.following ? 'pi pi-check' : 'pi pi-plus'"
                  [severity]="company.following ? 'success' : 'secondary'"
                  [outlined]="!company.following"
                  (onClick)="toggleFollow(company.slug || company.id)"
                  styleClass="p-button-sm"
                ></p-button>
                <p-button
                  label="Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù"
                  icon="pi pi-briefcase"
                  (onClick)="viewCompany(company.slug || company.id)"
                  styleClass="p-button-primary p-button-sm"
                ></p-button>
              </div>
            </div>
          </p-card>
        }
      </div>
      
      <!-- Pagination -->
      <div class="pagination-container">
        <p-paginator
          [rows]="page_size"
          [totalRecords]="totalCount"
          [first]="(currentPage - 1) * page_size"
          (onPageChange)="onPageChange($event)"
          [rowsPerPageOptions]="[6, 12, 24, 48]"
        ></p-paginator>
      </div>
    </div>
  </section>
}

<!-- Empty State -->
@if (!loading && companiesData.length === 0) {
  <section class="companies-section">
    <div class="container">
      <div class="empty-state">
        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±ÙƒØ§Øª Ù…ØªØ§Ø­Ø©</p>
      </div>
    </div>
  </section>
}

<!-- Footer -->
<app-footer></app-footer>