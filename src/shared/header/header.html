<header class="header">
  <p-confirmDialog key="logout" [style]="{width: '350px'}" [rtl]="true" rejectButtonStyleClass="p-button-outlined"></p-confirmDialog>
  <nav class="navbar" [class.mobile-menu-open]="mobileOpen">
    <div class="container">
      <!-- Brand -->
      <div class="navbar-brand">
        <a routerLink="/">
          <img src="images/HireMe.png" alt="منصة التوظيف" class="logo" />
        </a>
      </div>

      <!-- Main nav links (shared) -->
      <ul class="navbar-nav" id="primary-nav" (click)="closeMobileMenu()">
          <li class="nav-item"
            routerLinkActive="active1"
            [routerLinkActiveOptions]="{ exact: false }">
          <a class="nav-link" (click)="routeToJobs()">الوظائف</a>
        </li>
        <li class="nav-item">
          <a (click)="notImplemented()" class="nav-link">الشركات</a>
        </li>
        <li class="nav-item">
          <a (click)="notImplemented()" class="nav-link">الرواتب</a>
        </li>
        <li class="nav-item">
          <a (click)="notImplemented()" class="nav-link">الموارد</a>
        </li>
        @if (isLoggedIn() && role() === 'jobseeker') {
        <li role="none">
          <button
            role="menuitem"
            type="button"
            (click)="logout()"
            class="menu-link danger"
          >
            <i class="pi pi-sign-out menu-ic" aria-hidden="true"></i
            ><span>تسجيل الخروج</span>
          </button>
        </li>
        }
      </ul>

      <!-- Right side actions (change per mode) -->
      <div class="navbar-actions" dir="rtl" (click)="closeMobileMenu()">
        <!-- ========== Public header (login / register) ========== -->
         @if (!isLoggedIn()) {
            <a routerLink="/login" class="btn btn-secondary" routerLinkActive="active">تسجيل الدخول</a>
            <a routerLink="/register" class="btn btn-secondary" routerLinkActive="active">إنشاء حساب</a>
          }

        <!-- ========== Employer header ========== -->
         @if (isLoggedIn() && role() === 'employer') {

           <div class="navbar-actions company" (click)="$event.stopPropagation()">
             <div style="position: relative">
               <button
                 class="btn btn-secondary"
                 (click)="toggleEmployerMenu($event)"
               >
                 <img
                   [src]="logoUrl() || 'images/company-logo-1.jpg'"
                   alt="شركة التقنيات المتقدمة"
                   style="
                     width: 24px;
                     height: 24px;
                     border-radius: 4px;
                     margin-left: 0.5rem;
                   "
                 />
                 {{ companyName() }}
               </button>
               <div
                 class="user-menu"
                 *ngIf="isEmployerMenuOpen"
                 (click)="$event.stopPropagation()"
               >
                 <a class="user-menu-item" (click)="navigate('dashboard')"
                   >لوحة التحكم</a
                 >
                 <a class="user-menu-item" (click)="navigate('profile')"
                   >ملف الشركة</a
                 >
                 <a class="user-menu-item" (click)="navigate('user-edit')"
                   >تعديل الملف الشخصي</a
                 >
                 <a class="user-menu-item" (click)="navigate('post-job')"
                   >نشر وظيفة</a
                 >
                 
                 <a
                   class="user-menu-item"
                   (click)="navigate('employer-settings')"
                   >الإعدادات</a
                 >
                 <a class="user-menu-item-logout" (click)="logout()"
                   >تسجيل الخروج</a
                 >
               </div>
             </div>
           </div>
         }
      </div>

      <!-- Mobile Menu Toggle -->
      <button
        class="mobile-menu-toggle"
        type="button"
        (click)="toggleMobileMenu()"
        [class.active]="mobileOpen"
        aria-label="فتح القائمة"
        [attr.aria-expanded]="mobileOpen"
        aria-controls="primary-nav"
      >
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <!-- Backdrop for mobile -->
   @if(mobileOpen){
     <div
       class="mobile-backdrop"
       (click)="closeMobileMenu()"
     ></div>
   }
</header>
